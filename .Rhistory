rm(list=ls())
library(readxl)
library(tidyverse)
library(ggthemes)
library(ggthemes)
rm(list=ls())
library(readxl)
library(tidyverse)
library(ggthemes)
data <- read_excel("Data_Update.xlsx",
col_types = c("date", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric"))
data <- data$DATE["2017-10-31":]
data <- data$DATE["2017-10-31":]
data <- data[order(data$DATE),] #order by date
# Import data from excel sheet
data <- read_excel("Data_Update.xlsx",
col_types = c("date", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric"))
data <- data[order(data$DATE),] #order by date
?subset
data <- subset(data, DATE < as.Date("2017-10-31") )
View(data)
data$per_nav_return <- log(data$CORN_NAV/lag(data$CORN_NAV))
View(data)
data$per_etf_return <- log(data$CORN_MID/lag(data$CORN_MID))
data$asset_basket <- (data$`F1(.35)` * 0.35) + (data$`F2(.3)` * 0.3) + (data$`F3(.35)` * 0.35) # calculate asset basket
data$per_asset_return <- log(data$asset_basket/lag(data$asset_basket)) #calculate daily return in asset basket
data$etf_asset_error <- data$per_etf_return - data$per_asset_return #calculate error (%) between etf and asset
#-------------Exploratory Plots----------------------------#
qplot(data$DATE, (data$etf_asset_error * 100), geom='line') + theme_bw() +
ggtitle('Daily Return Error: CORN ETF - Asset Basket') +
ylab('Error (%)') + xlab('') + ylim(-7,5)
data <- na.omit(data) # remove all rows with NA, which are the last day of roll rows
#-------------Exploratory Plots----------------------------#
qplot(data$DATE, (data$etf_asset_error * 100), geom='line') + theme_bw() +
ggtitle('Daily Return Error: CORN ETF - Asset Basket') +
ylab('Error (%)') + xlab('') + ylim(-7,5)
TE1 <- sum(abs(data$etf_asset_error)) / nrow(data)
model <- lm(data$etf_asset_error ~ data$`C WASDE` + data$`C WASDE + CP` + data$`C Grain Stocks` +
data$`C Prospective Plantings` + data$`C Acreage Report` + data$`C Cattle on Feed` +
data$`C Hogs & Pigs` + data$`C Day Before Roll` + data$`C Day After Roll` +
data$`C Feb` + data$`C Mar` + data$`C April` + data$`C May` + data$`C June` +
data$`C July` + data$`C Aug` + data$`C Sept` + data$`C Oct` + data$`C Nov` +
data$`C Dec` + data$`C 2012` + data$`C 2013` + data$`C 2014` + data$`C 2015` +
data$`C 2016` + data$`C 2017` + data$`C 2018` + data$`C 2019` + data$`C 2020`,
data = data)
summary(modle)
summary(model)
model <- lm(data$etf_asset_error ~ data$`C WASDE` + data$`C WASDE + CP` + data$`C Grain Stocks` +
data$`C Prospective Plantings` + data$`C Acreage Report` + data$`C Cattle on Feed` +
data$`C Hogs & Pigs` + data$`C Day Before Roll` + data$`C Day After Roll` +
data$`C Feb` + data$`C Mar` + data$`C April` + data$`C May` + data$`C June` +
data$`C July` + data$`C Aug` + data$`C Sept` + data$`C Oct` + data$`C Nov` +
data$`C Dec` + data$`C 2012` + data$`C 2013` + data$`C 2014` + data$`C 2015` +
data$`C 2016` + data$`C 2017`,
data = data)
summary(model)
model <- lm(data$etf_asset_error ~ data$`C WASDE` + data$`C WASDE + CP` + data$`C Grain Stocks` +
data$`C Prospective Plantings` + data$`C Acreage Report` + data$`C Cattle on Feed` +
data$`C Hogs & Pigs` + data$`C Day Before Roll` + data$`C Day After Roll` +
data$`C Feb` + data$`C Mar` + data$`C April` + data$`C May` + data$`C June` +
data$`C July` + data$`C Aug` + data$`C Sept` + data$`C Oct` + data$`C Nov` +
data$`C Dec` + data$`C 2012` + data$`C 2013` + data$`C 2014` + data$`C 2015` +
data$`C 2016`,
data = data)
summary(model)
model <- lm(data$etf_asset_error ~ data$`C WASDE` + data$`C WASDE + CP` + data$`C Grain Stocks` +
data$`C Prospective Plantings` + data$`C Acreage Report` + data$`C Cattle on Feed` +
data$`C Hogs & Pigs` + data$`C Day Before Roll` + data$`C Day After Roll` +
data$`C Feb` + data$`C Mar` + data$`C April` + data$`C May` + data$`C June` +
data$`C July` + data$`C Aug` + data$`C Sept` + data$`C Oct` + data$`C Nov` +
data$`C Dec` + data$`C 2012` + data$`C 2013` + data$`C 2014` + data$`C 2015` +
data$`C 2017`,
data = data)
summary(model)
model <- lm(abs(data$etf_asset_error) ~ data$`C WASDE` + data$`C WASDE + CP` + data$`C Grain Stocks` +
data$`C Prospective Plantings` + data$`C Acreage Report` + data$`C Cattle on Feed` +
data$`C Hogs & Pigs` + data$`C Day Before Roll` + data$`C Day After Roll` +
data$`C Feb` + data$`C Mar` + data$`C April` + data$`C May` + data$`C June` +
data$`C July` + data$`C Aug` + data$`C Sept` + data$`C Oct` + data$`C Nov` +
data$`C Dec` + data$`C 2012` + data$`C 2013` + data$`C 2014` + data$`C 2015` +
data$`C 2017`,
data = data)
summary(model)
model <- lm(abs(data$etf_asset_error) ~ abs(data$per_etf_return) + data$`C WASDE` + data$`C WASDE + CP` + data$`C Grain Stocks` +
data$`C Prospective Plantings` + data$`C Acreage Report` + data$`C Cattle on Feed` +
data$`C Hogs & Pigs` + data$`C Day Before Roll` + data$`C Day After Roll` +
data$`C Feb` + data$`C Mar` + data$`C April` + data$`C May` + data$`C June` +
data$`C July` + data$`C Aug` + data$`C Sept` + data$`C Oct` + data$`C Nov` +
data$`C Dec` + data$`C 2012` + data$`C 2013` + data$`C 2014` + data$`C 2015` +
data$`C 2017`,
data = data)
summary(model)
